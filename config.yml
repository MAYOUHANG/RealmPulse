# ============================================================
# RealmPulse - Admin Friendly Config (UTF-8)
# ============================================================
# 使用说明（强烈建议先看）：
# 1) 修改后建议执行：/rp reload
# 2) API Key 建议通过游戏内指令设置，避免明文传播：
#    /rp qakey <your_key>
#    /rp summarykey <your_key>
# 3) 推荐先用一键套餐测试：
#    /rp profile lowcost|balanced|pro
# 4) 推荐在高峰服启用场景自动调度：
#    /rp scene auto on
#
# 常见问题：
# - 时段格式必须是 HH:mm-HH:mm，例如 18:00-22:59
# - 所有概率都在 0.0~1.0 之间
# - 模型或接口填错时，AI 会无回复

# ------------------------------------------------------------
# 核心模块（机器人数量、聊天频率）
# ------------------------------------------------------------
core:
  # 机器人总数（建议 10~50）
  # 注意：过高会影响真实感与性能，推荐先从 20 测试。
  ghost-count: 20

  # 机器人空闲发言检查间隔（秒）
  # 数字越小，越“热闹”；数字越大，越“安静”
  # 推荐：高峰 70~120，低峰 180~260
  chat-interval: 120

# ------------------------------------------------------------
# 聊天显示格式
# ------------------------------------------------------------
chat:
  # 可用变量：{prefix} {name} {message}
  # 支持颜色代码：&a &b 等
  format: "&r{prefix} &f{name}&8 » &f{message}"

# ------------------------------------------------------------
# AI 总开关 + 双通道（问答 / 总结）
# ------------------------------------------------------------
ai:
  # 全局 AI 总开关（false = 全部 AI 关闭）
  enabled: true

  # 问答通道：用于玩家问句实时回复（推荐用便宜快速模型）
  qa:
    enabled: true
    api-url: "https://api.siliconflow.cn/v1/chat/completions"
    api-key: "YOUR_API_KEY_HERE"
    model: "deepseek-ai/DeepSeek-V3"
    # 问答 token 建议 32~96，避免成本飙升
    max-tokens: 64
    system-prompt: "你是 Craft to Exile 2 服务器中的拟真玩家。回答必须简短、自然、口语化，不要暴露你是 AI。"

  # 总结通道：用于学习语料提炼（可用更强模型）
  summary:
    enabled: true
    api-url: "https://api.siliconflow.cn/v1/chat/completions"
    api-key: "YOUR_API_KEY_HERE"
    model: "deepseek-ai/DeepSeek-R1"
    # 总结 token 建议 160~400
    max-tokens: 220
    system-prompt: "你负责提炼服务器聊天语料。输出精炼短句，每行一条，不要解释。"

# ------------------------------------------------------------
# 管理员指令消息风格
# ------------------------------------------------------------
admin-ui:
  # 前缀支持 HEX 颜色，例如 &#79C7F6
  prefix: "&#79C7F6&lR&#98DEF7&lP &8| &r"

# ------------------------------------------------------------
# 行为事件概率
# ------------------------------------------------------------
events:
  # 新玩家首次进服时，机器人欢迎参与比例权重
  welcome-chance: 0.6

  # AI 对话后，机器人跟进回复比例权重
  reply-chance: 0.15

  # 空闲自说自话倾向（保留扩展）
  solo-chance: 0.7

  # 跟话概率（跟随上一条机器人回复）
  ghost-followup-chance: 0.2

  # 真实玩家被提及时，机器人主动搭话概率
  player-mention-reply-chance: 0.02
  player-mention-reply-boost-chance: 0.06
  fake-mention-dialogue-enabled: true
  ghost-mention-back-chance: 0.45

  # 英文机器人占比（0~1）
  english-ghost-ratio: 0.5

  # 英文对话模块
  english-dialogue-enabled: true
  english-dialogue-interval-seconds: 240
  english-dialogue-chance: 0.15
  english-dialogue-participation-ratio: 0.15
  english-dialogue-use-ai: true
  english-dialogue-ai-chance: 0.75

# ------------------------------------------------------------
# 死亡广播模拟
# ------------------------------------------------------------
death-settings:
  enabled: true
  chance: 0.05
  cmi-format: "&#9BB7D4{name} &7{reason}"
  death-reasons:
    - "被坠落的铁砧砸扁了"
    - "试图拥抱仙人掌"
    - "落地过猛"
    - "浸在火里"
    - "在墙里窒息而亡"
    - "掉出了这个世界"
    - "随着一声巨响消失了"

# ------------------------------------------------------------
# 上下线模拟
# ------------------------------------------------------------
connection-settings:
  enabled: true
  interval-seconds: 30
  quit-chance: 0.02
  rejoin-chance: 0.1
  cmi-join-format: "&e{name}&e 加入了游戏"
  cmi-quit-format: "&e{name}&e 退出了游戏"

# ------------------------------------------------------------
# 文案池（欢迎、闲聊、跟话等）
# ------------------------------------------------------------
messages:
  welcome-phrases:
    - "welcome"
    - "hello newcomer"
    - "welcome to the server"
    - "have fun"
    - "欢迎新人"
    - "新人你好"
    - "欢迎欢迎"
    - "欢迎加入我们"
    - "欢迎来到本服"
    - "热烈欢迎"

  idle-phrases:
    - "1"
    - "..."
    - "anyone mining?"
    - "server lagging?"
    - "who is online"
    - "any dungeon run?"
    - "挖半天啥都没"
    - "怎么圈地来着"
    - "箱子怎么上锁"
    - "有 tpa 吗"
    - "afk"
    - "挂机一会"
    - "服主在不"
    - "有人吗"
    - "666"
    - "求带"
    - "这波可以"
    - "感谢大佬"

  agreement-phrases:
    - "true"
    - "1"
    - "yep"
    - "agree"
    - "正解"
    - "确实"

  prevent-tpa: "&c该玩家拒绝传送请求。"

  # @真实玩家 提及模板
  player-mention-templates:
    - "{player} 我们晚点一起下本？"
    - "@{player} 你路线怎么走的"
    - "{player} 记得带方块和食物"
  player-mention-templates-zh:
    - "{player} 我们晚点一起下本？"
    - "@{player} 你路线怎么走的"
    - "{player} 记得带方块和食物"
  player-mention-templates-en:
    - "{player} we can run dungeon later"
    - "@{player} what route do you use"
    - "{player} bring blocks and food"
  ghost-mention-templates:
    - "@{target} 先补给一下"
    - "@{target} 先跟着{speaker}走"
  ghost-mention-templates-zh:
    - "@{target} 先补给一下"
    - "@{target} 先跟着{speaker}走"
  ghost-mention-templates-en:
    - "@{target} which route are you running"
    - "@{target} can you take farm side"
  ghost-mention-reply-templates:
    - "ok 我来处理 {topic}"
    - "收到 我去打 {topic}"
  ghost-mention-reply-templates-zh:
    - "ok 我来处理 {topic}"
    - "收到 我去打 {topic}"
  ghost-mention-reply-templates-en:
    - "got it i can cover {topic}"
    - "ok i will handle {topic}"

  # 消息末尾附加 @玩家 的概率
  append-player-id-chance: 0.01
  append-player-id-boost-chance: 0.03
  player-id-format: "{message} @{player}"

  # 打字延迟模拟（tick，20tick=1秒）
  typing-base-min-ticks: 15
  typing-base-max-ticks: 35
  typing-per-char-ticks: 2

  # 去重窗口：最近 N 条不重复
  no-repeat-window: 40
  no-repeat-similarity-threshold: 0.84
  repeat-rewrite-attempts: 2
  filter-offline-player-mentions: true
  ghost-dialogue-memory-size: 80

  # 英文对话素材
  english-seed-phrases:
    - "anyone doing dungeon runs"
    - "i just got a decent drop"
    - "we need more iron for gear"
    - "spawn area looks better now"
    - "i can help with boss prep"
  english-reply-prefixes:
    - "yeah"
    - "true"
    - "same"
    - "agreed"
    - "exactly"
  english-content-templates:
    - "we should optimize {topic} before boss"
    - "focus {topic} first then push nether"
    - "if {topic} is ready we can speedrun dungeon"
    - "let us farm {topic} for better gear"
    - "team up on {topic} and split resources"
  english-topics:
    - "gear"
    - "iron"
    - "farm"
    - "dungeon"
    - "boss"
    - "route"
    - "trade"
  follow-up-templates:
    - "we can plan {topic} first"
    - "better to prep {topic} before fight"
    - "lets split work on {topic}"
    - "i can handle {topic} side"
    - "先准备 {topic} 再出发"
    - "{topic} 先搞定会更稳"

# ------------------------------------------------------------
# 学习模块（从真实玩家聊天中提炼短句）
# ------------------------------------------------------------
learning:
  enabled: true
  min-length: 2
  max-length: 36
  pending-max-size: 300
  raw-max-size: 2000
  api-summary-enabled: true
  summary-batch-size: 20
  summary-min-filtered-size: 8
  summary-cooldown-seconds: 30
  summary-input-max-length: 90
  qa-idle-blend-chance: 0.20
  summary-dedup-similarity-threshold: 0.86
  summary-copy-similarity-threshold: 0.93
  block-contains:
    - "http://"
    - "https://"
    - "www."
    - "discord.gg"
    - "cheat"
    - "sell"

# ------------------------------------------------------------
# TAB 前缀兜底（无权限组时）
# ------------------------------------------------------------
tab:
  default-prefix-fallback: "&7[玩家]&f"

# ------------------------------------------------------------
# 自动场景调度（高峰/低峰/活动）
# ------------------------------------------------------------
scene-auto:
  # 是否开启自动调度（也可用命令 /rp scene auto on）
  enabled: false

  # 时区，务必与你服务器运营时区一致
  # 常见：中国 = Asia/Shanghai
  timezone: "Asia/Shanghai"

  # 检查频率（秒）
  check-interval-seconds: 60

  # 全局优先级（多个时段重叠时先匹配谁）
  priority:
    - "promo"
    - "peak"
    - "quiet"

  # 全局默认时段（当 weekday/weekend 未配置命中时使用）
  slots:
    promo:
      - "12:00-12:59"
    peak:
      - "18:00-22:59"
    quiet:
      - "00:00-11:59"
      - "23:00-23:59"

  # 工作日时段（周一~周五）
  weekday:
    priority:
      - "promo"
      - "peak"
      - "quiet"
    slots:
      promo:
        - "12:00-12:30"
      peak:
        - "19:00-22:59"
      quiet:
        - "00:00-11:59"
        - "23:00-23:59"

  # 周末时段（周六~周日）
  weekend:
    priority:
      - "promo"
      - "peak"
      - "quiet"
    slots:
      promo:
        - "14:00-16:00"
      peak:
        - "20:00-23:30"
      quiet:
        - "00:00-13:59"

# ------------------------------------------------------------
# Fake advancement broadcast simulator
# ------------------------------------------------------------
advancement-events:
  enabled: true
  interval-seconds: 120
  trigger-chance: 0.20
  min-online-real-players: 1

  # Cooldowns / rate limits
  global-min-interval-seconds: 75
  per-ghost-min-interval-seconds: 300
  global-max-per-hour: 20
  per-ghost-max-per-hour: 3
  max-completions-per-ghost: 300

  # Filters
  exclude-namespaces:
    - "minecraft:recipes"
  exclude-key-contains:
    - "recipes/"

  # Placeholders: {name} {advancement} {key}
  message-format: "&6[Advancement] &e{name} has made the advancement &a[{advancement}]"
